<?xml version="1.0" encoding="utf-8"?>
<ui:FluentWindow x:Class="WpfInteractionApp.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:pages="clr-namespace:WpfInteractionApp.Pages"
                 Title="Contextualizer"
                 Height="800"
                 Width="1200"
                 WindowStartupLocation="CenterScreen"
                 ExtendsContentIntoTitleBar="True"
                 WindowBackdropType="Mica"
                 WindowCornerPreference="Round">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- TitleBar -->
        <ui:TitleBar x:Name="TitleBar"
                     Title="Contextualizer"
                     Grid.Row="0"
                     CloseWindowByDoubleClickOnIcon="True">
            <ui:TitleBar.Header>
                <StackPanel Orientation="Horizontal" Margin="0,0,8,0">
                    <ui:Button x:Name="ThemeToggleButton"
                               Appearance="Transparent"
                               Click="ThemeToggle_Click"
                               ToolTip="Theme">
                        <ui:SymbolIcon x:Name="ThemeToggleIcon" Symbol="WeatherMoon24" />
                    </ui:Button>

                    <ui:Button x:Name="ManualHandlersButton"
                               Appearance="Transparent"
                               Click="ManualHandlersButton_Click"
                               ToolTip="Manual handlers"
                               Margin="4,0,0,0">
                        <ui:SymbolIcon Symbol="Flash24" />
                    </ui:Button>

                    <ui:Button Appearance="Transparent"
                               Click="ReloadHandlers_Click"
                               ToolTip="Reload handlers"
                               Margin="4,0,0,0">
                        <ui:SymbolIcon Symbol="ArrowClockwise24" />
                    </ui:Button>

                    <ui:Button Appearance="Transparent"
                               Click="OpenLoggingSettings_Click"
                               ToolTip="Logging settings"
                               Margin="4,0,0,0">
                        <ui:SymbolIcon Symbol="ClipboardTextEdit24" />
                    </ui:Button>
                </StackPanel>
            </ui:TitleBar.Header>
        </ui:TitleBar>

        <!-- Main Navigation -->
        <ui:NavigationView x:Name="RootNavigation"
                           Grid.Row="1"
                           PaneDisplayMode="LeftFluent"
                           IsBackButtonVisible="Collapsed"
                           IsPaneToggleVisible="True"
                           OpenPaneLength="240">

            <ui:NavigationView.Header>
                <TextBlock x:Name="PageTitleText"
                           Margin="42,24,0,0"
                           FontSize="22"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource TextFillColorPrimaryBrush}" />
            </ui:NavigationView.Header>

            <ui:NavigationView.MenuItems>
                <ui:NavigationViewItem Content="Dashboard"
                                       NavigationCacheMode="Enabled"
                                       TargetPageType="{x:Type pages:DashboardPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Home24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>

                <ui:NavigationViewItem Content="Handlers"
                                       NavigationCacheMode="Enabled"
                                       TargetPageType="{x:Type pages:HandlersPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="ClipboardTask24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>

                <ui:NavigationViewItem Content="Cron Jobs"
                                       NavigationCacheMode="Disabled"
                                       TargetPageType="{x:Type pages:CronPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Timer24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>

                <ui:NavigationViewItem Content="Marketplace"
                                       NavigationCacheMode="Disabled"
                                       TargetPageType="{x:Type pages:MarketplacePage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Cart24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>

                <ui:NavigationViewItem Content="Activity Log"
                                       NavigationCacheMode="Enabled"
                                       TargetPageType="{x:Type pages:LogViewerPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="History24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>
            </ui:NavigationView.MenuItems>

            <ui:NavigationView.FooterMenuItems>
                <ui:NavigationViewItem Content="Settings"
                                       NavigationCacheMode="Enabled"
                                       TargetPageType="{x:Type pages:SettingsPage}">
                    <ui:NavigationViewItem.Icon>
                        <ui:SymbolIcon Symbol="Settings24" />
                    </ui:NavigationViewItem.Icon>
                </ui:NavigationViewItem>
            </ui:NavigationView.FooterMenuItems>
        </ui:NavigationView>

        <!-- Snackbar host (required for WPF UI snackbars) -->
        <ui:SnackbarPresenter x:Name="RootSnackbarPresenter"
                              Grid.Row="1"
                              VerticalAlignment="Bottom"
                              HorizontalAlignment="Right"
                              Margin="24" />
    </Grid>
</ui:FluentWindow>



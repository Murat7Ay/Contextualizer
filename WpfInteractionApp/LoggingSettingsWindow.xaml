<Window x:Class="WpfInteractionApp.LoggingSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Logging Settings" Height="650" Width="700"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource Carbon.Brush.Background.Primary}"
        Foreground="{DynamicResource Carbon.Brush.Text.Primary}"
        Style="{DynamicResource Carbon.Window}">
    
    <Window.Resources>
        <!-- Modern Card Style for Settings Sections -->
        <Style x:Key="SettingsCard" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource Carbon.Brush.Background.Secondary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Carbon.Brush.Background.Tertiary}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" Opacity="0.08" BlurRadius="8" ShadowDepth="2"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card Header Style -->
        <Style x:Key="CardHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource Carbon.Brush.Text.Primary}"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Form Field Container -->
        <Style x:Key="FieldContainer" TargetType="StackPanel">
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <!-- Field Label Style -->
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{DynamicResource Carbon.Brush.Text.Primary}"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>

        <!-- Enhanced TextBox Style -->
        <Style TargetType="TextBox" BasedOn="{StaticResource Carbon.TextBox}">
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="Padding" Value="12,8"/>
        </Style>

        <!-- Enhanced CheckBox Style -->
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource Carbon.Brush.Text.Primary}"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <!-- Enhanced ComboBox Style -->
        <Style TargetType="ComboBox" BasedOn="{StaticResource Carbon.ComboBox}">
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="Padding" Value="12,8"/>
        </Style>

        <!-- Enhanced ComboBoxItem Style -->
        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource Carbon.ComboBoxItem}"/>

        <!-- Enhanced Slider Style -->
        <Style TargetType="Slider">
            <Setter Property="Foreground" Value="{DynamicResource Carbon.Brush.Interactive.Primary}"/>
            <Setter Property="Height" Value="20"/>
        </Style>

        <!-- Info Text Style -->
        <Style x:Key="InfoText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{DynamicResource Carbon.Brush.Text.Secondary}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,8,0,0"/>
        </Style>

        <!-- Statistics Display Style -->
        <Style x:Key="StatValue" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{DynamicResource Carbon.Brush.Interactive.Primary}"/>
        </Style>
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Local Logging Settings Card -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Local Logging" Style="{StaticResource CardHeader}"/>
                        
                        <CheckBox x:Name="EnableLocalLoggingCheckBox" 
                                  Content="Enable Local Logging" 
                                  IsChecked="{Binding EnableLocalLogging}"/>
                        
                        <StackPanel Style="{StaticResource FieldContainer}">
                            <TextBlock Text="Log Directory" Style="{StaticResource FieldLabel}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="LogDirectoryTextBox" 
                                         Text="{Binding LocalLogPath}"
                                         Grid.Column="0"/>
                                <Button Content="Browse..." 
                                        Grid.Column="1"
                                        Margin="8,0,0,0" 
                                        Click="BrowseLogDirectory_Click"
                                        Style="{DynamicResource Carbon.Button.Secondary}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Style="{StaticResource FieldContainer}">
                            <TextBlock Text="Minimum Log Level" Style="{StaticResource FieldLabel}"/>
                            <ComboBox x:Name="MinimumLogLevelComboBox" 
                                      SelectedValue="{Binding MinimumLogLevel}"
                                      SelectedValuePath="Tag"
                                      Width="200" HorizontalAlignment="Left">
                                <ComboBoxItem Content="Debug" Tag="Debug"/>
                                <ComboBoxItem Content="Info" Tag="Info"/>
                                <ComboBoxItem Content="Warning" Tag="Warning"/>
                                <ComboBoxItem Content="Error" Tag="Error"/>
                                <ComboBoxItem Content="Critical" Tag="Critical"/>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Style="{StaticResource FieldContainer}">
                            <TextBlock Text="Maximum File Size" Style="{StaticResource FieldLabel}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="MaxFileSizeSlider" 
                                        Grid.Column="0"
                                        Minimum="1" Maximum="50" 
                                        Value="{Binding MaxLogFileSizeMB}" 
                                        TickFrequency="5" 
                                        IsSnapToTickEnabled="True"
                                        Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1"
                                           Text="{Binding ElementName=MaxFileSizeSlider, Path=Value, StringFormat='{}{0} MB'}" 
                                           Style="{StaticResource StatValue}"
                                           VerticalAlignment="Center"
                                           MinWidth="60"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Style="{StaticResource FieldContainer}">
                            <TextBlock Text="Maximum File Count" Style="{StaticResource FieldLabel}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="MaxFileCountSlider" 
                                        Grid.Column="0"
                                        Minimum="1" Maximum="20" 
                                        Value="{Binding MaxLogFileCount}" 
                                        TickFrequency="1" 
                                        IsSnapToTickEnabled="True"
                                        Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1"
                                           Text="{Binding ElementName=MaxFileCountSlider, Path=Value, StringFormat='{}{0} files'}" 
                                           Style="{StaticResource StatValue}"
                                           VerticalAlignment="Center"
                                           MinWidth="80"/>
                            </Grid>
                        </StackPanel>

                        <CheckBox x:Name="EnableDebugModeCheckBox" 
                                  Content="Enable Debug Mode (Verbose Logging)" 
                                  IsChecked="{Binding EnableDebugMode}"/>
                    </StackPanel>
                </Border>

                <!-- Usage Analytics Settings Card -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Usage Analytics" Style="{StaticResource CardHeader}"/>
                        
                        <CheckBox x:Name="EnableUsageTrackingCheckBox" 
                                  Content="Enable Usage Analytics (Anonymous)" 
                                  IsChecked="{Binding EnableUsageTracking}"/>
                        
                        <StackPanel Style="{StaticResource FieldContainer}">
                            <TextBlock Text="Analytics Endpoint URL" Style="{StaticResource FieldLabel}"/>
                            <TextBox x:Name="UsageEndpointUrlTextBox" 
                                     Text="{Binding UsageEndpointUrl}"
                                     IsEnabled="{Binding ElementName=EnableUsageTrackingCheckBox, Path=IsChecked}"/>
                        </StackPanel>

                        <TextBlock Text="Usage analytics help improve the application by collecting anonymous performance and usage data. No personal information is collected."
                                   Style="{StaticResource InfoText}"/>
                    </StackPanel>
                </Border>

                <!-- Log Statistics Card -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Log Statistics" Style="{StaticResource CardHeader}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Current Log Directory -->
                            <StackPanel Grid.Column="0" Grid.Row="0" Margin="0,0,12,12">
                                <TextBlock Text="Current Directory" Style="{StaticResource FieldLabel}"/>
                                <TextBlock x:Name="CurrentLogDirectoryText" 
                                           Text="{Binding CurrentLogDirectory}"
                                           Style="{StaticResource StatValue}"
                                           TextTrimming="CharacterEllipsis"
                                           ToolTip="{Binding CurrentLogDirectory}"/>
                            </StackPanel>
                            
                            <!-- Total Log Files -->
                            <StackPanel Grid.Column="1" Grid.Row="0" Margin="0,0,12,12">
                                <TextBlock Text="Total Files" Style="{StaticResource FieldLabel}"/>
                                <TextBlock x:Name="TotalLogFilesText" 
                                           Text="{Binding TotalLogFiles}"
                                           Style="{StaticResource StatValue}"/>
                            </StackPanel>
                            
                            <!-- Total Log Size -->
                            <StackPanel Grid.Column="2" Grid.Row="0" Margin="0,0,0,12">
                                <TextBlock Text="Total Size" Style="{StaticResource FieldLabel}"/>
                                <TextBlock x:Name="TotalLogSizeText" 
                                           Text="{Binding TotalLogSize}"
                                           Style="{StaticResource StatValue}"/>
                            </StackPanel>
                        </Grid>

                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <Button Content="Open Log Folder" 
                                    Click="OpenLogFolder_Click"
                                    Style="{DynamicResource Carbon.Button.Secondary}"
                                    Margin="0,0,8,0"/>
                            <Button Content="Clear Old Logs" 
                                    Click="ClearOldLogs_Click"
                                    Style="{DynamicResource Carbon.Button.Warning}"
                                    Margin="0,0,8,0"/>
                            <Button Content="Refresh Statistics" 
                                    Click="RefreshStatistics_Click"
                                    Style="{DynamicResource Carbon.Button.Secondary}"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Quick Actions Card -->
                <Border Style="{StaticResource SettingsCard}">
                    <StackPanel>
                        <TextBlock Text="Quick Actions" Style="{StaticResource CardHeader}"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <Button Content="Test Error Log" 
                                    Click="TestErrorLog_Click"
                                    Style="{DynamicResource Carbon.Button.Secondary}"
                                    Margin="0,0,8,0"/>
                            <Button Content="Test Usage Analytics" 
                                    Click="TestUsageAnalytics_Click"
                                    Style="{DynamicResource Carbon.Button.Info}"
                                    Margin="0,0,8,0"/>
                            <Button Content="Export Configuration" 
                                    Click="ExportConfiguration_Click"
                                    Style="{DynamicResource Carbon.Button.Secondary}"/>
                        </StackPanel>
                        
                        <TextBlock Text="Use these buttons to test the logging system and verify configuration."
                                   Style="{StaticResource InfoText}"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <StackPanel Grid.Row="1" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,10,0,0">
            <Button Content="Cancel"
                    Style="{DynamicResource Carbon.Button.Secondary}"
                    Click="CancelButton_Click"
                    MinWidth="100"
                    Margin="0,0,12,0"/>
            
            <Button Content="Apply"
                    Style="{DynamicResource Carbon.Button.Secondary}"
                    Click="ApplyButton_Click"
                    MinWidth="100"
                    Margin="0,0,12,0"/>
            
            <Button Content="Save"
                    Style="{DynamicResource Carbon.Button.Base}"
                    Click="SaveButton_Click"
                    MinWidth="100"/>
        </StackPanel>
    </Grid>
</Window>